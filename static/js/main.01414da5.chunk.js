(this["webpackJsonpremy-room-display"]=this["webpackJsonpremy-room-display"]||[]).push([[0],{134:function(e,t,a){},135:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(23),i=a.n(c),l=a(2),o=a.n(l),u=a(5),s=a(3),m=(a(60),a(4)),d=a.n(m),f=a(6),p=a.n(f),v=(a(63),function(e){var t=Object(n.useState)("10:00"),a=Object(s.a)(t,2);a[0],a[1];return r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){e.onAdd&&e.onAdd()}},"Book now"))}),E=function(e){return r.a.createElement("div",{style:{padding:"10px"}},r.a.createElement("div",null,p()(e.start.dateTime).tz("Europe/Paris").format("hh:mm")," - ",p()(e.end.dateTime).tz("Europe/Paris").format("hh:mm")),e.onDelete&&r.a.createElement("button",{onClick:function(){e.onDelete&&e.onDelete(e.id)}},"Delete Booking"))},h=a(52),b=a.n(h),O=a(11),y=a.n(O),j="https://nets-intranets-api.azurewebsites.net";function g(e){return new Promise((function(t,a){b()(e).then((function(e){t(e.data)})).catch((function(e){a(e)}))}))}function k(e){return g({method:"get",url:j+"/v1.0/rooms/"+e+"/todays-bookings",headers:{}})}function w(e){return g({method:"get",url:j+"/v1.0/rooms/"+e,headers:{}})}function N(){var e={method:"get",url:j+"/v1.0/rooms",headers:{}};return new Promise((function(t,a){g(e).then((function(e){e.value=y.a.sortBy(e.value,["displayName"]),t(e)})).catch((function(e){return a(e)}))}))}function x(){var e={method:"get",url:j+"/v1.0/sites",headers:{}};return new Promise((function(t,a){g(e).then((function(e){e.value=y.a.sortBy(e.value,["displayName"]),t(e)})).catch((function(e){return a(e)}))}))}function S(e){var t={method:"get",url:j+"/v1.0/sites/"+e,headers:{}};return new Promise((function(e,a){g(t).then((function(t){t.value=y.a.sortBy(t.value,["displayName"]),e(t)})).catch((function(e){return a(e)}))}))}function Y(e,t,a){return g({method:"post",url:j+"/v1.0/bookings/"+e,headers:{"Content-Type":"application/json"},data:{startDateTime:t,endDateTime:a,timeZone:"UTC"}})}function M(e,t){return g({method:"delete",url:j+"/v1.0/bookings/"+e+"/"+t,headers:{"Content-Type":"application/json"}})}a(42);function T(e,t){var a,n,r,c,i;a=!0;d()(t).startOf("day").toISOString();var l=d()(t).endOf("day").toISOString();n=d()(t),r=l;return e.forEach((function(e){var l=d()(e.start.dateTime),o=d()(e.end.dateTime);!i&&d()(l).isAfter(d()())&&(i=e,r=d()(e.start.dateTime)),d()(t).isBetween(l,o)&&(a=!1,c=e,n=d()(e.end.dateTime))})),[a,n,r,c,i]}function D(e){for(var t=[],a=7;a<18;a++)for(var n=0;n<60;n+=15)t.push({hour:a,min:n,bookings:[],status:"free"});return t}a(43);var A=function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),c=a[0],i=a[1];Object(n.useEffect)((function(){function t(){return(t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:k(e.email).then((function(e){return b(e.value)})),w(e.email).then((function(e){i(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.email]);var l=Object(n.useState)(""),m=Object(s.a)(l,2),d=(m[0],m[1],Object(n.useState)([])),f=Object(s.a)(d,2),h=f[0],b=f[1],O=T(h,p()()),y=Object(s.a)(O,6),j=y[0],g=(y[1],y[2],y[3]),N=y[4],x=y[5],S=function(){return r.a.createElement("div",{className:j?"room-available":"room-buzy",style:{fontSize:"100px",textAlign:"center"}},j&&r.a.createElement("div",null,r.a.createElement("div",{className:"status-block"},r.a.createElement("div",{className:"status-heading"},"Available"),r.a.createElement("div",{className:"status-subheading"},"Available next ",x)),r.a.createElement(v,{onAdd:function(){var t=Object(u.a)(o.a.mark((function t(a,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=p()().format("YYYY-MM-DDTHH:mm:00"),n=p()().add(15,"m").format("YYYY-MM-DDTHH:mm:00"),t.next=4,Y(e.email,a,n);case 4:window.location.reload();case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()})),!j&&r.a.createElement("div",null,r.a.createElement(E,Object.assign({onDelete:function(){var t=Object(u.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M(e.email,a);case 2:window.location.reload();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},g))))},D=function(){return r.a.createElement("div",{className:"displaytitle"}," ",c.displayName," ")},A=function(){return N?r.a.createElement("div",null,"Next booking",r.a.createElement(E,N)):r.a.createElement("div",null,"No upcoming meetings")},H=function(){var e=p()().format("HH:MM"),t=p()().format("dddd, MMMM D, YYYY");return r.a.createElement("div",{className:"clock"},r.a.createElement("div",{className:"clock-hm"},e),r.a.createElement("div",{className:"clock-day"},t))};return r.a.createElement("div",null,r.a.createElement(D,null),r.a.createElement(S,null),r.a.createElement("div",{className:"next"},r.a.createElement("div",{className:"nextHeader"},"NEXT"),r.a.createElement(A,null)),r.a.createElement(H,null))},H=a(8),z=(a(28),function(e){var t=Object(n.useState)([]),a=Object(s.a)(t,2),c=a[0],i=a[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N().then((function(e){return i(e.value)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var l=Object(n.useState)(""),m=Object(s.a)(l,2);m[0],m[1];return r.a.createElement("div",null,"ROOMS",r.a.createElement("div",null,c.map((function(e,t){return r.a.createElement("div",null,e.displayName," (",e.emailAddress,")",r.a.createElement(H.a,{to:"/room/"+e.emailAddress+"/display"},"display"),r.a.createElement("a",{href:"https://outlook.office.com/calendar/"+e.emailAddress}," ","Outlook Calendar"))}))))}),B=function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),c=a[0],i=a[1];Object(n.useEffect)((function(){function t(){return(t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:k(e.email).then((function(e){return b(e.value)})),w(e.email).then((function(e){i(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.email]);var l=Object(n.useState)(""),m=Object(s.a)(l,2),d=(m[0],m[1],Object(n.useState)([])),f=Object(s.a)(d,2),h=f[0],b=f[1],O=T(h,p()()),y=Object(s.a)(O,6),j=y[0],g=(y[1],y[2],y[3]),N=y[4],x=y[5],S=function(){return r.a.createElement("div",{className:j?"room-available":"room-buzy",style:{fontSize:"100px",textAlign:"center"}},j&&r.a.createElement("div",null,r.a.createElement("div",{className:"status-block"},r.a.createElement("div",{className:"status-heading"},"Available"),r.a.createElement("div",{className:"status-subheading"},"Available next ",x)),r.a.createElement(v,{onAdd:function(){var t=Object(u.a)(o.a.mark((function t(a,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=p()().format("YYYY-MM-DDTHH:mm:00"),n=p()().add(15,"m").format("YYYY-MM-DDTHH:mm:00"),t.next=4,Y(e.email,a,n);case 4:window.location.reload();case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()})),!j&&r.a.createElement("div",null,r.a.createElement(E,Object.assign({onDelete:function(){var t=Object(u.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M(e.email,a);case 2:window.location.reload();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},g))))},D=function(){return r.a.createElement("div",{className:"displaytitle"}," ",c.displayName," ")},A=function(){return N?r.a.createElement("div",null,"Next booking",r.a.createElement(E,N)):r.a.createElement("div",null,"No upcoming meetings")},H=function(){var e=p()().format("HH:MM"),t=p()().format("dddd, MMMM D, YYYY");return r.a.createElement("div",{className:"clock"},r.a.createElement("div",{className:"clock-hm"},e),r.a.createElement("div",{className:"clock-day"},t))};return r.a.createElement("div",null,r.a.createElement(D,null),r.a.createElement(S,null),r.a.createElement("div",{className:"next"},r.a.createElement("div",{className:"nextHeader"},"NEXT"),r.a.createElement(A,null)),r.a.createElement(H,null))},C=function(e){var t=Object(n.useState)([]),a=Object(s.a)(t,2),c=a[0],i=a[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x().then((function(e){return i(e.value)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var l=Object(n.useState)(""),m=Object(s.a)(l,2);m[0],m[1];return r.a.createElement("div",null,"SITES",r.a.createElement("div",null,c.map((function(e,t){return r.a.createElement("div",null,r.a.createElement(H.a,{to:"/sites/"+e.emailAddress},e.displayName))}))))},P=a(53),I=a.n(P),R=(a(133),function(e){return r.a.createElement("div",{style:{display:"flex"}},e.slots.map((function(e,t){return r.a.createElement("div",{key:t,class:"slot slot-"+e.status},e.hour,":",e.min,e.bookings&&e.bookings.map((function(e,t){return r.a.createElement("div",{key:t},e.subject)})))})))}),_=function(e){return r.a.createElement(I.a,{groups:e.groups,items:e.items,defaultTimeStart:d()().add(-12,"hour"),defaultTimeEnd:d()().add(12,"hour")})},J=function(e){var t=Object(n.useState)([]),a=Object(s.a)(t,2),c=a[0],i=a[1],l=Object(n.useState)(!1),m=Object(s.a)(l,2),d=m[0],f=m[1],p=Object(n.useState)(0),v=Object(s.a)(p,2),E=v[0],h=v[1],b=Object(n.useState)([]),O=Object(s.a)(b,2),j=O[0],g=O[1],w=Object(n.useState)([]),N=Object(s.a)(w,2),x=N[0],Y=N[1];Object(n.useEffect)((function(){function t(){return(t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!d){t.next=2;break}return t.abrupt("return");case 2:S(e.email).then(function(){var e=Object(u.a)(o.a.mark((function e(t){var a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),i(t.value),a=0,n=[],r=[],t.value.forEach(function(){var e=Object(u.a)(o.a.mark((function e(c){var l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(c.emailAddress);case 2:(l=e.sent).value.forEach((function(e){r.push({id:r.length+1,group:c.emailAddress,title:"item 1",start_time:e.start.dateTime,end_time:e.end.dateTime})})),n.push({id:c.emailAddress,title:c.displayName}),c.bookings=l.value,a++,h(a),i(t.value);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Y(r),g(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[E]);var M=Object(n.useState)(""),T=Object(s.a)(M,2);T[0],T[1];return r.a.createElement("div",null,"ROOMS",r.a.createElement("div",null,c.map((function(e,t){return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"columnn-room"},r.a.createElement("a",{target:"_blank",href:"https://outlook.office.com/calendar/"+e.emailAddress}," ",e.displayName," ")),e.bookings&&r.a.createElement("div",null,e.bookings.length,r.a.createElement(R,{slots:D(e.bookings)})))}))),r.a.createElement(_,{groups:y.a.cloneDeep(j),items:y.a.cloneDeep(x)}))};a(134);var X=function(){var e=function(){return null};return r.a.createElement("div",{className:"section min-height-100"},r.a.createElement("div",{className:"container  min-height-100"},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{padding:10}},r.a.createElement(H.a,{to:"/sites"},"Sites")),r.a.createElement("div",{style:{padding:10}},r.a.createElement(H.a,{to:"/room"},"Rooms"))),r.a.createElement(H.b,null,r.a.createElement(e,{path:"/"}),r.a.createElement(C,{path:"/sites"}),r.a.createElement(J,{path:"/sites/:email"}),r.a.createElement(z,{path:"/room"}),r.a.createElement(B,{path:"/room/:email"}),r.a.createElement(A,{path:"/room/:email/display"}))))};i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(X,null)),document.getElementById("root"))},28:function(e,t,a){},43:function(e,t,a){},54:function(e,t,a){e.exports=a(135)},60:function(e,t,a){}},[[54,1,2]]]);
//# sourceMappingURL=main.01414da5.chunk.js.map