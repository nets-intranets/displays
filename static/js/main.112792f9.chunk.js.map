{"version":3,"sources":["components/RoomDisplay.js","logic/intranets-api/index.js","containers/RoomDisplayPage.js","logic/bookings/index.js","App.js","index.js"],"names":["AddBooking","props","useState","onClick","onAdd","ViewBooking","style","padding","organizer","emailAddress","name","address","momenttz","start","dateTime","tz","format","end","onDelete","id","host","callAxios","config","Promise","resolve","reject","axios","then","response","data","catch","error","getRoomBookingsForToday","email","method","url","headers","getRoom","addBooking","startDateTime","endDateTime","deleteBooking","RoomDisplay","room","setRoom","refresh","useTimer","autoStart","expiryTimestamp","Date","now","onExpire","console","warn","seconds","minutes","hours","days","isRunning","pause","resume","restart","useEffect","a","setRoomBookings","value","run","roomBookings","bookings","isAvailable","currentBooking","moment","startOf","toISOString","endOf","forEach","booking","bookedFrom","bookedTo","isBetween","availableFrom","availableTo","nextBooking","getCurrentBookingStatus","availableText","className","displayName","fontSize","textAlign","add","window","location","reload","map","App","title","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.112792f9.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\nimport \"./display.css\"\r\nimport moment from \"moment\"\r\nimport momenttz from \"moment-timezone\"\r\nimport TimePicker from 'react-time-picker';\r\n\r\nexport const Buzy = (props) => {\r\n    return (  <div className=\"buzy-container\">{props.title}\r\n    <div className=\"buzy-container-status-red\">\r\n\r\n    </div>\r\n    </div>);\r\n}\r\n\r\nexport const Free = () => {\r\n    return (  <div>Free</div>);\r\n}\r\n\r\nexport const Next = () => {\r\n    return (  <div>Next</div>);\r\n}\r\n\r\nexport const AddBooking = (props) => {\r\n    const [value, onChange] = useState('10:00');\r\n    /**\r\n     *  <TimePicker\r\n        onChange={onChange}\r\n        value={value}\r\n      />\r\n     */\r\n    return (  <div>\r\n       \r\n        <button onClick={()=>{\r\n            if (props.onAdd){\r\n                props.onAdd()\r\n            }\r\n        }}>Add Booking</button>\r\n        </div>);\r\n}\r\n \r\n \r\n\r\nexport const ViewBooking = (props) => {\r\n    return (  <div style={{padding:\"10px\"}}>\r\n         <div>Organizer: {props.organizer.emailAddress.name} ({props.organizer.emailAddress.address})</div>\r\n        <div>{momenttz(props.start.dateTime).tz(\"Europe/Paris\").format(\"hh:mm\")} - {momenttz(props.end.dateTime).tz(\"Europe/Paris\").format(\"hh:mm\")}</div>\r\n        <button onClick={()=>{\r\n            if (props.onDelete){\r\n                props.onDelete(props.id)\r\n            }\r\n        }}>Delete Booking</button>\r\n        </div>); \r\n}\r\n\r\n","import axios from \"axios\";\r\nconst host = false ? \"https://nets-intranets-api.azurewebsites.net\" : \"http://localhost:8000\"\r\n\r\nfunction callAxios(config) {\r\n  return new Promise((resolve, reject) => {\r\n    axios(config)\r\n      .then(function (response) {\r\n        resolve(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        reject(error);\r\n      });\r\n  });\r\n}\r\n\r\nexport function getRoomBookingsForToday(email) {\r\n    \r\nvar config = {\r\n  method: 'get',\r\n  url: host + '/v1.0/rooms/ConfRoom2@niegrejoh.onmicrosoft.com/todays-bookings',\r\n  headers: { \r\n    'Cookie': 'ARRAffinity=ff0fc5d39aabac4576907838eb0a630c9b0bc10114083b2334023199b7c16e27'\r\n  }\r\n};\r\n\r\nreturn callAxios(config)\r\n}\r\n\r\nexport function getRoom(email) {\r\n    \r\n  var config = {\r\n    method: 'get',\r\n    url: host + '/v1.0/rooms/ConfRoom2@niegrejoh.onmicrosoft.com',\r\n    headers: { \r\n      'Cookie': 'ARRAffinity=ff0fc5d39aabac4576907838eb0a630c9b0bc10114083b2334023199b7c16e27'\r\n    }\r\n  };\r\n  \r\n  return callAxios(config)\r\n  }\r\n  \r\n\r\n  export function addBooking(email,startDateTime,endDateTime) {\r\n    \r\n    var data = {startDateTime,endDateTime,\"timeZone\":\"UTC\"}\r\n\r\n    var config = {\r\n      method: 'post',\r\n      url: host + '/v1.0/bookings/'+email,\r\n      headers: { \r\n        'Content-Type': 'application/json'\r\n      },\r\n      data : data\r\n    };\r\n\r\n    return callAxios(config)\r\n    }\r\n    \r\n    export function deleteBooking(email,id) {\r\n    \r\n    \r\n      var config = {\r\n        method: 'delete',\r\n        url: host + '/v1.0/bookings/'+email + \"/\" + id,\r\n        headers: { \r\n          'Content-Type': 'application/json'\r\n        },\r\n        \r\n      };\r\n  \r\n      return callAxios(config)\r\n      }\r\n      ","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Free,\r\n  Buzy,\r\n  Next,\r\n  ViewBooking,\r\n  AddBooking,\r\n} from \"../components/RoomDisplay\";\r\nimport {\r\n  getRoom,\r\n  getRoomBookingsForToday,\r\n  addBooking,\r\n  deleteBooking,\r\n} from \"../logic/intranets-api\";\r\n\r\nimport { useTimer } from \"react-timer-hook\";\r\nimport { getCurrentBookingStatus } from \"../logic/bookings\";\r\nimport moment from \"moment-timezone\";\r\n\r\nimport \"./RoomDisplayPage.css\";\r\nconst RoomDisplay = (props) => {\r\n  const [room, setRoom] = useState({});\r\n  const [refresh, setRefresh] = useState(0);\r\n  const {\r\n    seconds,\r\n    minutes,\r\n    hours,\r\n    days,\r\n    isRunning,\r\n    start,\r\n    pause,\r\n    resume,\r\n    restart,\r\n  } = useTimer({\r\n    autoStart: true,\r\n    expiryTimestamp: Date.now() + 5000,\r\n    onExpire: () => console.warn(\"onExpire called\"),\r\n  });\r\n\r\n  useEffect(\r\n    () => {\r\n      async function run() {\r\n        getRoomBookingsForToday(props.email).then((data) =>\r\n          setRoomBookings(data.value)\r\n        );\r\n        getRoom(props.email).then((room) => {\r\n          \r\n          setRoom(room)});\r\n      }\r\n      run();\r\n    },\r\n    [props.email],\r\n    refresh\r\n  );\r\n\r\n  const [roomBookings, setRoomBookings] = useState([]);\r\n  var [\r\n    isAvailable,\r\n    availableFrom,\r\n    availableTo,\r\n    currentBooking,\r\n    nextBooking,\r\n    availableText\r\n  ] = getCurrentBookingStatus(roomBookings, moment());\r\n\r\n  /**\r\n   * <span>{days}</span>:<span>{hours}</span>:<span>{minutes}</span>:<span>{seconds}</span>\r\n   */\r\n  return (\r\n    <div>\r\n      <div className=\"displaytitle\"> {room.displayName} </div>\r\n      <div\r\n        className={isAvailable ? \"room-available\" : \"room-buzy\"}\r\n        style={{ fontSize: \"100px\", textAlign: \"center\" }}\r\n      >\r\n        {isAvailable && (\r\n          <div>\r\n          <div className=\"status-block\">\r\n            <div className=\"status-heading\">Available</div>\r\n            <div className=\"status-subheading\">Available next {availableText}</div>\r\n            </div>\r\n            <AddBooking\r\n              onAdd={async (startDateTime, endDateTime) => {\r\n                startDateTime = moment().format(\"YYYY-MM-DDTHH:mm:00\");\r\n\r\n                endDateTime = moment()\r\n                  .add(15, \"m\")\r\n                  .format(\"YYYY-MM-DDTHH:mm:00\");\r\n                await addBooking(props.room.email, startDateTime, endDateTime);\r\n                window.location.reload();\r\n                //setRefresh(refresh + 1);\r\n              }}\r\n            ></AddBooking>\r\n          </div>\r\n        )}\r\n        {!isAvailable && (\r\n          <div>\r\n            <ViewBooking\r\n              onDelete={async (id) => {\r\n                await deleteBooking(props.room.email, id);\r\n                window.location.reload();\r\n              }}\r\n              {...currentBooking}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div style={{ padding: \"16px\" }}></div>\r\n      {roomBookings.map((booking) => {\r\n        return (\r\n          <ViewBooking\r\n            onDelete={async (id) => {\r\n              await deleteBooking(props.room.email, id);\r\n              window.location.reload();\r\n            }}\r\n            {...booking}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RoomDisplay;\r\n","import moment from \"moment\";\r\n\r\nexport function getCurrentBookingStatus(bookings,now){\r\n    var isAvailable, availableFrom,availableTo,currentBooking,nextBooking \r\n\r\n    isAvailable = true\r\n    var startOfToday = moment(now).startOf(\"day\").toISOString();\r\n    var endOfToday = moment(now).endOf(\"day\").toISOString();\r\n\r\n    bookings.forEach(booking => {\r\n        var bookedFrom = moment(booking.start.dateTime)\r\n        var bookedTo = moment(booking.end.dateTime)\r\n\r\n        if (moment(now).isBetween(bookedFrom,bookedTo)){\r\n            isAvailable = false\r\n            currentBooking = booking\r\n        }\r\n        \r\n    });\r\n\r\n\r\n\r\n\r\nreturn [isAvailable,availableFrom,availableTo,currentBooking,nextBooking ]\r\n}","import React from 'react';\nimport HomePage from \"./containers/HomePage\"\nimport RoomDisplay from './containers/RoomDisplayPage';\nimport \"./App.css\"\nfunction App() {\n  return (\n    <div className=\"section min-height-100\">\n    <div className=\"container  min-height-100\">\n    <RoomDisplay room={{title:\"Room\",email:\"ConfRoom2@niegrejoh.onmicrosoft.com\"}}/>\n    </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\n//})"],"sourceRoot":""}