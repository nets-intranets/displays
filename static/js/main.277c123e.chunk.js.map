{"version":3,"sources":["components/RoomDisplay.js","logic/intranets-api/index.js","containers/RoomDisplayPage.js","logic/bookings/index.js","containers/RoomsPage.js","App.js","index.js"],"names":["AddBooking","props","useState","onClick","onAdd","ViewBooking","style","padding","momenttz","start","dateTime","tz","format","end","onDelete","id","host","callAxios","config","Promise","resolve","reject","axios","then","response","data","catch","error","getRoomBookingsForToday","email","method","url","headers","getRoom","getRooms","addBooking","startDateTime","endDateTime","deleteBooking","RoomDisplay","room","setRoom","useEffect","a","setRoomBookings","value","run","roomBookings","bookings","now","isAvailable","availableFrom","availableTo","currentBooking","nextBooking","moment","startOf","toISOString","endOfToday","endOf","forEach","booking","bookedFrom","bookedTo","isAfter","isBetween","getCurrentBookingStatus","availableText","CurrentStatus","className","fontSize","textAlign","add","window","location","reload","DisplayHeader","displayName","ComingUp","Clock","day","Rooms","rooms","setRooms","map","key","to","emailAddress","App","Home","path","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.277c123e.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\nimport \"./display.css\"\r\nimport moment from \"moment\"\r\nimport momenttz from \"moment-timezone\"\r\nimport TimePicker from 'react-time-picker';\r\n\r\nexport const Buzy = (props) => {\r\n    return (  <div className=\"buzy-container\">{props.title}\r\n    <div className=\"buzy-container-status-red\">\r\n\r\n    </div>\r\n    </div>);\r\n}\r\n\r\nexport const Free = () => {\r\n    return (  <div>Free</div>);\r\n}\r\n\r\nexport const Next = () => {\r\n    return (  <div>Next</div>);\r\n}\r\n\r\nexport const AddBooking = (props) => {\r\n    const [value, onChange] = useState('10:00');\r\n    /**\r\n     *  <TimePicker\r\n        onChange={onChange}\r\n        value={value}\r\n      />\r\n     */\r\n    return (  <div>\r\n       \r\n        <button onClick={()=>{\r\n            if (props.onAdd){\r\n                props.onAdd()\r\n            }\r\n        }}>Book now</button>\r\n        </div>);\r\n}\r\n \r\n \r\n\r\nexport const ViewBooking = (props) => {\r\n    return (  <div style={{padding:\"10px\"}}>\r\n        \r\n        <div>{momenttz(props.start.dateTime).tz(\"Europe/Paris\").format(\"hh:mm\")} - {momenttz(props.end.dateTime).tz(\"Europe/Paris\").format(\"hh:mm\")}</div>\r\n        {props.onDelete && <button onClick={()=>{\r\n            if (props.onDelete){\r\n                props.onDelete(props.id)\r\n            }\r\n        }}>Delete Booking</button>}\r\n        </div>); \r\n}\r\n\r\n","import axios from \"axios\";\r\nconst host = true ? \"https://nets-intranets-api.azurewebsites.net\" : \"http://localhost:8000\"\r\n\r\nfunction callAxios(config) {\r\n  return new Promise((resolve, reject) => {\r\n    axios(config)\r\n      .then(function (response) {\r\n        resolve(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        reject(error);\r\n      });\r\n  });\r\n}\r\n\r\nexport function getRoomBookingsForToday(email) {\r\n    \r\nvar config = {\r\n  method: 'get',\r\n  url: host + '/v1.0/rooms/'+email+'/todays-bookings',\r\n  headers: { \r\n    \r\n  }\r\n};\r\n\r\nreturn callAxios(config)\r\n}\r\n\r\nexport function getRoom(email) {\r\n    \r\n  var config = {\r\n    method: 'get',\r\n    url: host + '/v1.0/rooms/'+email,\r\n    headers: { \r\n      \r\n    }\r\n  };\r\n  \r\n  return callAxios(config)\r\n  }\r\n  \r\n\r\n  export function getRooms() {\r\n    \r\n    var config = {\r\n      method: 'get',\r\n      url: host + '/v1.0/rooms',\r\n      headers: { \r\n        \r\n      }\r\n    };\r\n    \r\n    return callAxios(config)\r\n    }\r\n    \r\n  export function addBooking(email,startDateTime,endDateTime) {\r\n    \r\n    var data = {startDateTime,endDateTime,\"timeZone\":\"UTC\"}\r\n\r\n    var config = {\r\n      method: 'post',\r\n      url: host + '/v1.0/bookings/'+email,\r\n      headers: { \r\n        'Content-Type': 'application/json'\r\n      },\r\n      data : data\r\n    };\r\n\r\n    return callAxios(config)\r\n    }\r\n    \r\n    export function deleteBooking(email,id) {\r\n    \r\n    \r\n      var config = {\r\n        method: 'delete',\r\n        url: host + '/v1.0/bookings/'+email + \"/\" + id,\r\n        headers: { \r\n          'Content-Type': 'application/json'\r\n        },\r\n        \r\n      };\r\n  \r\n      return callAxios(config)\r\n      }\r\n      ","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Free,\r\n  Buzy,\r\n  Next,\r\n  ViewBooking,\r\n  AddBooking,\r\n} from \"../components/RoomDisplay\";\r\nimport {\r\n  getRoom,\r\n  getRoomBookingsForToday,\r\n  addBooking,\r\n  deleteBooking,\r\n} from \"../logic/intranets-api\";\r\n\r\nimport { useTimer } from \"react-timer-hook\";\r\nimport { getCurrentBookingStatus } from \"../logic/bookings\";\r\nimport moment from \"moment-timezone\";\r\n\r\nimport \"./RoomDisplayPage.css\";\r\nconst RoomDisplay = (props) => {\r\n  \r\n  const [room, setRoom] = useState({});\r\n\r\n  useEffect(() => {\r\n    async function run() {\r\n      getRoomBookingsForToday(props.email).then((data) =>\r\n        setRoomBookings(data.value)\r\n      );\r\n      getRoom(props.email).then((room) => {\r\n        setRoom(room);\r\n      });\r\n    }\r\n    run();\r\n  }, [props.email]);\r\n\r\n  const [error, setError] = useState(\"\");\r\n  const [roomBookings, setRoomBookings] = useState([]);\r\n  var [\r\n    isAvailable,\r\n    availableFrom,\r\n    availableTo,\r\n    currentBooking,\r\n    nextBooking,\r\n    availableText,\r\n  ] = getCurrentBookingStatus(roomBookings, moment());\r\n\r\n  const CurrentStatus = () => {\r\n    return (\r\n      <div\r\n        className={isAvailable ? \"room-available\" : \"room-buzy\"}\r\n        style={{ fontSize: \"100px\", textAlign: \"center\" }}\r\n      >\r\n        {isAvailable && (\r\n          <div>\r\n            <div className=\"status-block\">\r\n              <div className=\"status-heading\">Available</div>\r\n              <div className=\"status-subheading\">\r\n                Available next {availableText}\r\n              </div>\r\n            </div>\r\n            <AddBooking\r\n              onAdd={async (startDateTime, endDateTime) => {\r\n                startDateTime = moment().format(\"YYYY-MM-DDTHH:mm:00\");\r\n\r\n                endDateTime = moment()\r\n                  .add(15, \"m\")\r\n                  .format(\"YYYY-MM-DDTHH:mm:00\");\r\n                await addBooking(props.email, startDateTime, endDateTime);\r\n                window.location.reload();\r\n                //setRefresh(refresh + 1);\r\n              }}\r\n            ></AddBooking>\r\n          </div>\r\n        )}\r\n        {!isAvailable && (\r\n          <div>\r\n            <ViewBooking\r\n              onDelete={async (id) => {\r\n                await deleteBooking(props.email, id);\r\n                window.location.reload();\r\n              }}\r\n              {...currentBooking}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n  const DisplayHeader = () => {\r\n    return <div className=\"displaytitle\"> {room.displayName} </div>;\r\n  };\r\n\r\n  const ComingUp = () => {\r\n    if (!nextBooking) return <div>No upcoming meetings</div>;\r\n    return (\r\n      <div>\r\n        Next booking\r\n        <ViewBooking {...nextBooking} />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const ListAllBookings = () => {\r\n    return (\r\n      <div>\r\n        <div style={{ padding: \"16px\" }}></div>\r\n        {roomBookings.map((booking) => {\r\n          return (\r\n            <ViewBooking\r\n              onDelete={async (id) => {\r\n                await deleteBooking(props.room.email, id);\r\n                window.location.reload();\r\n              }}\r\n              {...booking}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const Clock = () => {\r\n    var now = moment().format(\"HH:MM\");\r\n    var day = moment().format(\"dddd, MMMM D, YYYY\");\r\n    return (\r\n      <div className=\"clock\">\r\n        <div className=\"clock-hm\">{now}</div>\r\n\r\n        <div className=\"clock-day\">{day}</div>\r\n      </div>\r\n    );\r\n  };\r\n  /**\r\n   * <span>{days}</span>:<span>{hours}</span>:<span>{minutes}</span>:<span>{seconds}</span>\r\n   */\r\n  return (\r\n    <div>\r\n      <DisplayHeader />\r\n\r\n      <CurrentStatus />\r\n      <div className=\"next\">\r\n        <div className=\"nextHeader\">NEXT</div>\r\n        <ComingUp />\r\n      </div>\r\n\r\n      <Clock />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RoomDisplay;\r\n","import moment from \"moment\";\r\nimport _ from \"lodash\"\r\n\r\nfunction todayHourMinute(h,m){\r\n    var date = moment()\r\n    date .set('hour',h)\r\n    date .set('minute',m)\r\n}\r\nfunction booking(fromH,fromM,toH,toM,oranizer){\r\n\r\nreturn {\r\n    start : todayHourMinute(fromH,fromM),\r\n    end : todayHourMinute(toH,toM)\r\n\r\n}\r\n}\r\nexport function mockBooking(){\r\n\r\n    var bookings = []\r\n    bookings.push()\r\n}\r\n\r\nexport function getCurrentBookingStatus(bookings,now){\r\n    var isAvailable, availableFrom,availableTo,currentBooking,nextBooking \r\n\r\n    isAvailable = true\r\n  \r\n\r\n    var startOfToday = moment(now).startOf(\"day\").toISOString();\r\n    var endOfToday = moment(now).endOf(\"day\").toISOString();\r\n\r\n    availableFrom = moment(now)\r\n    availableTo = endOfToday\r\n\r\n//    bookings =  _.sortBy(bookings,[(o)=>{return o.start.dateTime}])\r\n    var foundCurrentBooking = false\r\n    bookings.forEach(booking => {\r\n        var bookedFrom = moment(booking.start.dateTime)\r\n        var bookedTo = moment(booking.end.dateTime)\r\n        \r\n        if (!nextBooking && moment(bookedFrom).isAfter(moment())){\r\n            nextBooking = booking\r\n            availableTo = moment(booking.start.dateTime)\r\n        }   \r\n                     \r\n\r\n        if (moment(now).isBetween(bookedFrom,bookedTo)){\r\n            isAvailable = false\r\n            currentBooking = booking\r\n            availableFrom = moment(booking.end.dateTime)\r\n            \r\n        }\r\n        \r\n    });\r\n    \r\n\r\n\r\n\r\nreturn [isAvailable,availableFrom,availableTo,currentBooking,nextBooking ]\r\n}","import React, { useState, useEffect } from \"react\";\r\nimport {Link} from \"@reach/router\"\r\nimport {\r\n  getRooms, getRoomBookingsForToday\r\n} from \"../logic/intranets-api\";\r\n\r\nimport \"./Rooms.css\";\r\nconst Rooms = (props) => {\r\n  \r\n  const [rooms, setRooms] = useState([]);\r\n\r\n  useEffect(() => {\r\n    async function run() {\r\n    getRooms().then(rooms=>setRooms(rooms.value))      \r\n    }\r\n    run();\r\n  }, []);\r\n\r\n  const [error, setError] = useState(\"\");\r\n  return (\r\n    <div>\r\n    ROOMS\r\n    <div>\r\n    {rooms.map((room,key)=>{\r\n\r\n      return <div><Link to={\"/room/\"+room.emailAddress}>{room.displayName}</Link></div>\r\n      \r\n    })}\r\n\r\n    </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Rooms;\r\n","import React from \"react\";\nimport HomePage from \"./containers/HomePage\";\nimport RoomDisplay from \"./containers/RoomDisplayPage\";\nimport Rooms from \"./containers/RoomsPage\";\nimport \"./App.css\";\nimport { Router, Link } from \"@reach/router\";\nfunction App() {\n  const Home = () => {\n    return (\n      <div>\n        <Link to=\"/room\">Rooms</Link>\n      </div>\n    );\n  };\n  return (\n    <div className=\"section min-height-100\">\n      <div className=\"container  min-height-100\">\n        <Router>\n          <Home path=\"/\" />\n\n          <Rooms path=\"/room\" />\n          <RoomDisplay path=\"/room/:email\" />\n        </Router>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\n//})"],"sourceRoot":""}