(this["webpackJsonpremy-room-display"]=this["webpackJsonpremy-room-display"]||[]).push([[0],{29:function(e,t,n){e.exports=n(80)},35:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),i=n.n(o),c=n(9),s=n.n(c),u=n(13),m=n(8),l=(n(35),n(3)),d=n.n(l),f=n(7),p=n.n(f),h=(n(39),function(e){var t=Object(a.useState)("10:00"),n=Object(m.a)(t,2);n[0],n[1];return r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){e.onAdd&&e.onAdd()}},"Add Booking"))}),b=function(e){return r.a.createElement("div",{style:{padding:"10px"}},r.a.createElement("div",null,"Organizer: ",e.organizer.emailAddress.name," (",e.organizer.emailAddress.address,")"),r.a.createElement("div",null,p()(e.start.dateTime).tz("Europe/Paris").format("hh:mm")," - ",p()(e.end.dateTime).tz("Europe/Paris").format("hh:mm")),r.a.createElement("button",{onClick:function(){e.onDelete&&e.onDelete(e.id)}},"Delete Booking"))},v=n(27),E=n.n(v);function g(e){return new Promise((function(t,n){E()(e).then((function(e){t(e.data)})).catch((function(e){n(e)}))}))}function y(e){return g({method:"get",url:"https://nets-intranets-api.azurewebsites.net/v1.0/room/todays-bookings/ConfRoom2@niegrejoh.onmicrosoft.com",headers:{Cookie:"ARRAffinity=ff0fc5d39aabac4576907838eb0a630c9b0bc10114083b2334023199b7c16e27"}})}function w(e){return new Promise((function(e,t){e({})}))}function O(e,t,n){return g({method:"post",url:"https://nets-intranets-api.azurewebsites.net/v1.0/book/"+e,headers:{"Content-Type":"application/json"},data:{startDateTime:t,endDateTime:n,timeZone:"UTC"}})}function j(e,t){return g({method:"delete",url:"https://nets-intranets-api.azurewebsites.net/v1.0/booking/"+e+"/"+t,headers:{"Content-Type":"application/json"}})}var k=n(28);var x=function(e){var t=Object(a.useState)({}),n=Object(m.a)(t,2),o=n[0],i=n[1],c=Object(a.useState)(0),l=Object(m.a)(c,2),f=l[0],v=(l[1],Object(k.useTimer)({autoStart:!0,expiryTimestamp:Date.now()+5e3,onExpire:function(){return console.warn("onExpire called")}}));v.seconds,v.minutes,v.hours,v.days,v.isRunning,v.start,v.pause,v.resume,v.restart;Object(a.useEffect)((function(){function t(){return(t=Object(u.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:y(e.email).then((function(e){return T(e.value)})),w(e.email).then((function(e){return i(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.email],f);var E=Object(a.useState)([]),g=Object(m.a)(E,2),x=g[0],T=g[1],D=function(e,t){var n,a;return n=!0,d()(t).startOf("day").toISOString(),d()(t).endOf("day").toISOString(),e.forEach((function(e){var r=d()(e.start.dateTime),o=d()(e.end.dateTime);d()(t).isBetween(r,o)&&(n=!1,a=e)})),[n,void 0,void 0,a,void 0]}(x,p()()),S=Object(m.a)(D,5),z=S[0];S[1],S[2],S[3],S[4];return r.a.createElement("div",null,"Room ",o.title," -",r.a.createElement("div",{style:{fontSize:"100px",textAlign:"center",backgroundColor:z?"green":"red"}},z?"available":"buzy"),r.a.createElement("div",{style:{padding:"16px"}},r.a.createElement(h,{onAdd:function(){var t=Object(u.a)(s.a.mark((function t(n,a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=p()().format("YYYY-MM-DDTHH:mm:00"),a=p()().add(15,"m").format("YYYY-MM-DDTHH:mm:00"),t.next=4,O(e.room.email,n,a);case 4:window.location.reload();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),x.map((function(t){return r.a.createElement(b,Object.assign({onDelete:function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j(e.room.email,n);case 2:window.location.reload();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},t))})))};n(79);var T=function(){return r.a.createElement("div",{className:"section min-height-100"},r.a.createElement("div",{className:"container  min-height-100"},r.a.createElement(x,{room:{title:"Room",email:"ConfRoom2@niegrejoh.onmicrosoft.com"}})))};i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.8bad30de.chunk.js.map